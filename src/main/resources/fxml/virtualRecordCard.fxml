<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.Button?>
<?import javafx.scene.control.DatePicker?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ListView?>
<?import javafx.scene.control.Tab?>
<?import javafx.scene.control.TabPane?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.ColumnConstraints?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.RowConstraints?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.text.Font?>

<BorderPane prefHeight="720.0" prefWidth="1000.0" style="-fx-background-color: linear-gradient(to bottom right, #f8f9fa, #e9ecef);" xmlns="http://javafx.com/javafx/23.0.1" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.cole.controller.VirtualRecordCardController">

    <!-- Header with avatar and student info -->
    <top>
        <HBox alignment="CENTER_LEFT" spacing="24" style="-fx-background-color: #fff; -fx-background-radius: 12; -fx-padding: 18 32 18 32; -fx-effect: dropshadow(gaussian, #dee2e6, 8, 0.1, 0, 2);">
            <children>
                <!-- Avatar or icon -->
                <VBox alignment="CENTER" spacing="6">
                    <Label style="-fx-font-size: 48px;" text="ðŸ‘¤" />
                </VBox>
                <!-- Student info grid -->
                <GridPane hgap="24" vgap="8">
                    <columnConstraints>
                        <ColumnConstraints minWidth="100" />
                        <ColumnConstraints minWidth="200" />
                        <ColumnConstraints minWidth="100" />
                        <ColumnConstraints minWidth="200" />
                    </columnConstraints>
                    <children>
                        <Label style="-fx-font-weight: bold;" text="Full Name:" />
                  <TextField fx:id="studentNameField" editable="false" focusTraversable="false" promptText="Full Name" style="-fx-background-color: transparent; -fx-border-color: transparent; -fx-padding: 0; -fx-font-size: 14;" GridPane.columnIndex="1" />
                        <Label style="-fx-font-weight: bold;" text="Student Number:" GridPane.columnIndex="2" />
                  <TextField fx:id="studentNumberField" editable="false" focusTraversable="false" promptText="Student Number" style="-fx-background-color: transparent; -fx-border-color: transparent; -fx-padding: 0; -fx-font-size: 14;" GridPane.columnIndex="3" />
                        <Label style="-fx-font-weight: bold;" text="Email:" GridPane.rowIndex="1" />
                  <TextField fx:id="studentEmailField" editable="false" focusTraversable="false" promptText="Email" style="-fx-background-color: transparent; -fx-border-color: transparent; -fx-padding: 0; -fx-font-size: 14;" GridPane.columnIndex="1" GridPane.rowIndex="1" />
                        <Label style="-fx-font-weight: bold;" text="Phone:" GridPane.columnIndex="2" GridPane.rowIndex="1" />
                  <TextField fx:id="studentPhoneField" editable="false" focusTraversable="false" promptText="Phone" style="-fx-background-color: transparent; -fx-border-color: transparent; -fx-padding: 0; -fx-font-size: 14;" GridPane.columnIndex="3" GridPane.rowIndex="1" />
                  <Label text="ID Number:" GridPane.rowIndex="2">
                     <font>
                        <Font name="System Bold" size="12.0" />
                     </font>
                  </Label>
                  <TextField fx:id="studentIDNumberField" editable="false" focusTraversable="false" promptText="ID Number" style="-fx-background-color: transparent; -fx-border-color: transparent; -fx-padding: 0; -fx-font-size: 14;" GridPane.columnIndex="1" GridPane.rowIndex="2" />
                        <Label style="-fx-font-weight: bold;" text="Status:" GridPane.columnIndex="2" GridPane.rowIndex="2" />
                  <TextField fx:id="studentStatusField" editable="false" focusTraversable="false" promptText="Status" style="-fx-background-color: transparent; -fx-border-color: transparent; -fx-padding: 0; -fx-font-size: 14;" GridPane.columnIndex="3" GridPane.rowIndex="2" />
                        <Label style="-fx-font-weight: bold;" text="Branch:" GridPane.rowIndex="3" />
                  <TextField fx:id="studentBranchField" editable="false" focusTraversable="false" promptText="Branch" style="-fx-background-color: transparent; -fx-border-color: transparent; -fx-padding: 0; -fx-font-size: 14;" GridPane.columnIndex="1" GridPane.rowIndex="3" />
                        <Label style="-fx-font-weight: bold;" text="SLP:" GridPane.columnIndex="2" GridPane.rowIndex="3" />
                  <TextField fx:id="studentSlpField" editable="false" focusTraversable="false" promptText="SLP" style="-fx-background-color: transparent; -fx-border-color: transparent; -fx-padding: 0; -fx-font-size: 14;" GridPane.columnIndex="3" GridPane.rowIndex="3" />
                    </children>
               <rowConstraints>
                  <RowConstraints />
                  <RowConstraints />
                  <RowConstraints />
                  <RowConstraints />
               </rowConstraints>
                </GridPane>
            </children>
        </HBox>
    </top>

    <!-- Tabs with icons and improved layout -->
    <center>
        <TabPane style="-fx-background-radius: 12; -fx-effect: dropshadow(gaussian, #dee2e6, 8, 0.1, 0, 2);" tabClosingPolicy="UNAVAILABLE">
            <tabs>
                <Tab text="ðŸ“š Modules">
                    <VBox spacing="10" style="-fx-background-color: #fdfdfe; -fx-background-radius: 12; -fx-padding: 16;">
                        <Label style="-fx-font-size: 17px; -fx-font-weight: bold; -fx-underline: true;" text="Modules &amp; Results" />
                        <TableView fx:id="moduleTable" editable="true" style="-fx-background-radius: 8; -fx-border-radius: 8;" VBox.vgrow="ALWAYS">
                            <columns>
                                <TableColumn fx:id="moduleCodeColumn" text="Module Code" />
                                <TableColumn fx:id="moduleNameColumn" text="Module Name" />
                                <TableColumn fx:id="bookIssuedColumn" text="Book Issued" />
                                <TableColumn fx:id="formativeColumn" text="Formative %" />
                                <TableColumn fx:id="summativeColumn" text="Summative %" />
                                <TableColumn fx:id="supplementaryColumn" text="Supplementary %" />
                            </columns>
                     <columnResizePolicy>
                        <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                     </columnResizePolicy>
                        </TableView>
                        <HBox alignment="CENTER_RIGHT">
                            <Button fx:id="handleReregisterButton" onAction="#handleReregistration" style="-fx-font-weight: bold; -fx-background-color: linear-gradient(to right, #51cf66, #38d9a9); -fx-text-fill: white; -fx-background-radius: 8;" text="Add Module (Re-Registration)" />
                        </HBox>
                    </VBox>
                </Tab>
                <Tab text="ðŸ“ Notes">
                    <VBox spacing="10" style="-fx-background-color: #fdfdfe; -fx-background-radius: 12; -fx-padding: 16;">
                        <Label style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-underline: true;" text="Notes" />
                        <ListView fx:id="noteList" style="-fx-background-radius: 8; -fx-border-radius: 8;" />
                        <HBox alignment="CENTER_RIGHT" spacing="10">
                            <TextField fx:id="noteInputField" promptText="Enter Note..." style="-fx-background-radius: 8;" />
                            <Button onAction="#handleAddNote" style="-fx-font-weight: bold; -fx-background-color: linear-gradient(to right, #339af0, #5c7cfa); -fx-text-fill: white; -fx-background-radius: 8;" text="Add Note" />
                        </HBox>
                    </VBox>
                </Tab>
                <Tab text="â° Follow-Ups">
                    <VBox spacing="10" style="-fx-background-color: #fdfdfe; -fx-background-radius: 12; -fx-padding: 16;">
                        <Label style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-underline: true;" text="Follow-Ups" />
                        <TableView fx:id="followUpTable" style="-fx-background-radius: 8; -fx-border-radius: 8;">
                            <columns>
                                <TableColumn fx:id="dueDateColumn" text="Due Date" />
                                <TableColumn fx:id="descriptionColumn" text="Description" />
                                <TableColumn fx:id="completedColumn" text="Completed" />
                            </columns>
                     <columnResizePolicy>
                        <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                     </columnResizePolicy>
                        </TableView>
                        <HBox alignment="CENTER_RIGHT" spacing="10">
                            <DatePicker fx:id="followUpDueDateField" prefHeight="25.0" prefWidth="193.0" promptText="Due Date" style="-fx-background-radius: 8;" />
                            <TextField fx:id="followUpDescField" prefHeight="25.0" prefWidth="464.0" promptText="Description" style="-fx-background-radius: 8;" HBox.hgrow="ALWAYS" />
                            <Button fx:id="handleAddFollowUpButton" onAction="#handleAddFollowUp" style="-fx-font-weight: bold; -fx-background-color: linear-gradient(to right, #ff922b, #fab005); -fx-text-fill: white; -fx-background-radius: 8;" text="Add Follow Up" />
                        </HBox>
                    </VBox>
                </Tab>
            </tabs>
        </TabPane>
    </center>

    <!-- Sticky footer for actions -->
    <bottom>
        <HBox alignment="CENTER_RIGHT" spacing="10" style="-fx-background-color: #fff; -fx-background-radius: 12; -fx-padding: 12 32;">
            <Button fx:id="handleStudentReportButton" onAction="#handleStudentReport" style="-fx-font-weight: bold; -fx-background-color: linear-gradient(to right, #4df7b0ff, #2bc95aff); -fx-text-fill: white; -fx-background-radius: 8;" text="Export Student Report" />
            <Button fx:id="handleEditStudentButton" onAction="#handleEditStudent" style="-fx-font-weight: bold; -fx-background-color: linear-gradient(to right, #845ef7, #5f3dc4); -fx-text-fill: white; -fx-background-radius: 8;" text="Edit Student" />
            <Button fx:id="handleDeleteStudentButton" onAction="#handleDeleteStudent" style="-fx-font-weight: bold; -fx-background-color: linear-gradient(to right, #fa5252, #e03131); -fx-text-fill: white; -fx-background-radius: 8;" text="Delete Student" />
            <Button fx:id="handleCloseButton" onAction="#handleClose" style="-fx-font-weight: bold; -fx-background-color: linear-gradient(to right, #868e96, #adb5bd); -fx-text-fill: white; -fx-background-radius: 8;" text="Close" />
        </HBox>
    </bottom>
</BorderPane>
